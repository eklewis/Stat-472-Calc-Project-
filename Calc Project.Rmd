---
title: "Stat 472 Calc Project"
author: "Emma, Jackson, Amanda, Megan"
date: "3/3/2020"
output: pdf_document
---

1. Data required for the Calculus retention study is in S1 File in the Supporting Information section of the paper. S2 File has information about the survey questions and response codings in the data set. Load the data and understand each column.


```{r echo=FALSE, message=FALSE}
#install.packages("dplyr")
#install.packages("tidyr")
#install.packages("knitr")
#install.packages("kableExtra")


library(dplyr)
library(tidyr)
library(knitr)
library(kableExtra)
library(forcats)
```



```{r}
data <- read.csv("CSPCC_Switcher_Data.csv")
data$Q3FUS=paste(data$Q3FUS_No, data$Q3FUS_Yes)

```


# Switcher Coding

Switcher Groups

```{r}
s1 <- data %>% filter(Q26 == 1, Q3FUS_No == "No")
s2 <- data %>% filter(Q26 == 3, Q3FUS_No == "No")
s3 <- data %>% filter(is.na(Q26),Q5Post == 1, Q3FUS_No == "No")
s4 <- data %>% filter(is.na(Q26),Q5Post == 3, Q3FUS_No == "No")
s5 <- data %>% filter(Q26 == 1, Q3Post == 3, Q5Post == 1, Q3FUS_No != "No", Q3FUS_Yes != "Yes")
s6 <- data %>% filter(Q26 ==1, Q3Post == 2, Q3FUS_No != "No", Q3FUS_Yes != "Yes")
s7 <- data %>% filter(Q26 == 3, Q5Post == 1, Q3Post == 3, Q3FUS_No != "No", Q3FUS_Yes != "Yes")
s8 <- data %>% filter(Q26 == 3, Q3Post == 2, Q3FUS_No != "No", Q3FUS_Yes != "Yes")
s9 <- data %>% filter(is.na(Q26), Q5Post == 1, Q3Post ==3, Q3FUS_No != "No", Q3FUS_Yes != "Yes")
s10 <- data %>% filter(is.na(Q26), Q5Post ==1, Q3Post ==2, Q3FUS_No != "No", Q3FUS_Yes != "Yes")
s11 <- data %>% filter(is.na(Q26), Q5Post == 3, Q3Post ==2, Q3FUS_No != "No", Q3FUS_Yes != "Yes")
```


Persister Groups

```{r}
p12 <- data %>% filter(Q26 == 1, Q3FUS_Yes == "Yes")

p13 <- data %>% filter(Q26 == 3, Q3FUS_Yes == "Yes")

p14 <- data %>% filter(is.na(Q26), Q5Post == 1, Q3FUS_Yes == "Yes")

p15 <- data %>% filter(is.na(Q26), Q5Post == 3, Q3FUS_Yes == "Yes")

p16 <- data %>% filter(Q26 == 1, Q3Post == 1, Q3FUS_No != "No", Q3FUS_Yes != "Yes")

p17 <- data %>% filter(Q26 == 1, Q5Post == 3, Q3Post == 3, Q3FUS_No != "No", Q3FUS_Yes != "Yes")

p18 <- data %>% filter(Q26 == 1, Q5Post == 2, Q3Post == 3, Q3FUS_No != "No", Q3FUS_Yes != "Yes" )

p19 <- data %>% filter(Q26 == 1, is.na(Q5Post), Q3Post == 3, Q3FUS_No != "No", Q3FUS_Yes != "Yes")

p20 <- data %>% filter(Q26 == 3, Q3Post == 1, Q3FUS_No != "No", Q3FUS_Yes != "Yes")

p21 <- data %>% filter(Q26 == 3, Q5Post == 3, Q3Post == 3, Q3FUS_No != "No", Q3FUS_Yes != "Yes")


p22 <- data %>% filter(Q26 == 3, Q5Post == 2, Q3Post == 3, Q3FUS_No != "No", Q3FUS_Yes != "Yes")

p23 <- data %>% filter(Q26 == 3, is.na(Q5Post), Q3Post == 3, Q3FUS_No != "No", Q3FUS_Yes != "Yes" ) 

p24 <- data %>% filter(is.na(Q26), Q5Post == 1, Q3Post == 1, Q3FUS_No != "No", Q3FUS_Yes != "Yes")

p25 <- data %>% filter(is.na(Q26), Q5Post == 3, Q3Post == 1, Q3FUS_No != "No", Q3FUS_Yes != "Yes")

p26 <- data %>% filter(is.na(Q26), Q5Post == 3, Q3Post == 3, Q3FUS_No != "No", Q3FUS_Yes != "Yes")


```

```{r}

switchdata <- rbind(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26)

```

Table s1:

```{r}
x1=c("1", "2", "3", "4", "5", "6","7", "8", "9", "10", "11")
x2=c(length(s1), length(s2), length(s3), length(s4), length(s5), length(s6), length(s7), length(s8), length(s9), length(s10), length(s11))
x3=

switchdata %>%
  select(Q26, Q5Post, Q3Post, Q3FUS) %>%
  mutate(x2)

```




2. Prepare the data for analysis using S3 File. You should be left with 2,266 students (rows) after data preparation.

3. Reproduce the tables S1, S5, S6, S7, and S8.
Caution: There could be a typo in table S1.

```{r}
switchdata <- switchdata %>% 
  mutate(major = fct_collapse(factor(switchdata$Q60, levels=1:16), 
                              `1` = c("3","4","5","7","8","9"), 
                              `2` = "6", 
                              `3` = c("1","2"),
                              `4` = c("10","11","12","13","14","15"),
                              `5` = "16"))
```


Heads-up: Do you really have all the data that you need? Figure out what is missing and let us know... You can not do this homework without the missing information!


